<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>

    <style>
        body {
            margin: 0;
        }

        .hidden {
            display: none;
        }

        img {
            max-width: 90vw;
            max-height: 90vh;
        }

        .container {
            display: flex;
            justify-content: center;
            align-items: center;
            width: 100vw;
            height: 100vh;
        }

        .blue {
            background-color: hsl(236deg 47% 51%);
        }

        .green {
            background-color: hsl(129deg 50% 49%);
        }

        .red {
            background-color: hsl(358deg 51% 48%);
        }

        .frame {
            user-drag: none;
            -webkit-user-drag: none;
            user-select: none;
            -moz-user-select: none;
            -webkit-user-select: none;
            -ms-user-select: none;
        }
    </style>

    <div class="container blue">
        <img id="blue10" src="Render Square blue/0010.png" class="frame ">
        <img id="blue11" src="Render Square blue/0011.png" class="frame hidden">
        <img id="blue12" src="Render Square blue/0012.png" class="frame hidden">
        <img id="blue13" src="Render Square blue/0013.png" class="frame hidden">
        <img id="blue14" src="Render Square blue/0014.png" class="frame hidden">
        <img id="blue15" src="Render Square blue/0015.png" class="frame hidden">
        <img id="blue16" src="Render Square blue/0016.png" class="frame hidden">
        <img id="blue17" src="Render Square blue/0017.png" class="frame hidden">
        <img id="blue18" src="Render Square blue/0018.png" class="frame hidden">
        <img id="blue19" src="Render Square blue/0019.png" class="frame hidden">
        <img id="blue20" src="Render Square blue/0020.png" class="frame hidden">

        <img id="idleblue10" src="Render Square blue idle/0010.png" class="frame hidden">
        <img id="idleblue11" src="Render Square blue idle/0011.png" class="frame hidden">
        <img id="idleblue12" src="Render Square blue idle/0012.png" class="frame hidden">
        <img id="idleblue13" src="Render Square blue idle/0013.png" class="frame hidden">
        <img id="idleblue14" src="Render Square blue idle/0014.png" class="frame hidden">
        <img id="idleblue15" src="Render Square blue idle/0015.png" class="frame hidden">
        <img id="idleblue16" src="Render Square blue idle/0016.png" class="frame hidden">
        <img id="idleblue17" src="Render Square blue idle/0017.png" class="frame hidden">
        <img id="idleblue18" src="Render Square blue idle/0018.png" class="frame hidden">
        <img id="idleblue19" src="Render Square blue idle/0019.png" class="frame hidden">
        <img id="idleblue20" src="Render Square blue idle/0020.png" class="frame hidden">

        <img id="green10" src="Render Square green/0010.png" class="frame hidden">
        <img id="green11" src="Render Square green/0011.png" class="frame hidden">
        <img id="green12" src="Render Square green/0012.png" class="frame hidden">
        <img id="green13" src="Render Square green/0013.png" class="frame hidden">
        <img id="green14" src="Render Square green/0014.png" class="frame hidden">
        <img id="green15" src="Render Square green/0015.png" class="frame hidden">
        <img id="green16" src="Render Square green/0016.png" class="frame hidden">
        <img id="green17" src="Render Square green/0017.png" class="frame hidden">
        <img id="green18" src="Render Square green/0018.png" class="frame hidden">
        <img id="green19" src="Render Square green/0019.png" class="frame hidden">
        <img id="green20" src="Render Square green/0020.png" class="frame hidden">

        <img id="red10" src="Render Square red/0010.png" class="frame hidden">
        <img id="red11" src="Render Square red/0011.png" class="frame hidden">
        <img id="red12" src="Render Square red/0012.png" class="frame hidden">
        <img id="red13" src="Render Square red/0013.png" class="frame hidden">
        <img id="red14" src="Render Square red/0014.png" class="frame hidden">
        <img id="red15" src="Render Square red/0015.png" class="frame hidden">
        <img id="red16" src="Render Square red/0016.png" class="frame hidden">
        <img id="red17" src="Render Square red/0017.png" class="frame hidden">
        <img id="red18" src="Render Square red/0018.png" class="frame hidden">
        <img id="red19" src="Render Square red/0019.png" class="frame hidden">
        <img id="red20" src="Render Square red/0020.png" class="frame hidden">

        <img id="idlered10" src="Render Square red idle/0010.png" class="frame hidden">
        <img id="idlered11" src="Render Square red idle/0011.png" class="frame hidden">
        <img id="idlered12" src="Render Square red idle/0012.png" class="frame hidden">
        <img id="idlered13" src="Render Square red idle/0013.png" class="frame hidden">
        <img id="idlered14" src="Render Square red idle/0014.png" class="frame hidden">
        <img id="idlered15" src="Render Square red idle/0015.png" class="frame hidden">
        <img id="idlered16" src="Render Square red idle/0016.png" class="frame hidden">
        <img id="idlered17" src="Render Square red idle/0017.png" class="frame hidden">
        <img id="idlered18" src="Render Square red idle/0018.png" class="frame hidden">
        <img id="idlered19" src="Render Square red idle/0019.png" class="frame hidden">
        <img id="idlered20" src="Render Square red idle/0020.png" class="frame hidden">
    </div>


    <script>

        let colorIndex = 0
        const colors = [
            'blue',
            // 'green',
            'red'
        ]

        let idleAnimation;
        let idleAnimationTimeouts = []
        let playingAnimation = false;

        function restartIdleAnimation() {
            clearInterval(idleAnimation)
            idleAnimation = setInterval(() => {
                playIdleAnimation(10)
            }, 2000)
        }

        restartIdleAnimation()

        function hideIdleAnimations() {
            const imageSource = colors[colorIndex]
            for (let i = 10; i < 20; i++) {
                document.querySelector(`#idle${imageSource}${i}`).classList.add('hidden')
            }
        }

        function clearIdleAnimationTimeouts() {
            console.log('clear')
            idleAnimationTimeouts.forEach((a) => {
                clearTimeout(a)
            })
            idleAnimationTimeouts = []
        }

        function playAnimation(i) {
            playingAnimation = true
            const imageSource = colors[colorIndex]
            // console.log(i)
            document.querySelector(`#${imageSource}${i}`).classList.add('hidden')
            document.querySelector(`#${imageSource}${i + 1}`).classList.remove('hidden')

            if (i < 19) {
                setTimeout(() => {
                    playAnimation(i + 1)
                }, 1000 / 24)
            } else {
                playingAnimation = false
                colorIndex = (colorIndex + 1) % colors.length
                const nextImageSource = colors[colorIndex]
                document.querySelector(`#${imageSource}${i + 1}`).classList.add('hidden')
                document.querySelector(`#${nextImageSource}10`).classList.remove('hidden')
                document.querySelector(`.container`).classList.remove(imageSource)
                document.querySelector(`.container`).classList.add(nextImageSource)
            }
        }

        function playIdleAnimation(i) {
            const imageSource = colors[colorIndex]
            // console.log(i)
            document.querySelector(`#idle${imageSource}${i}`).classList.add('hidden')
            document.querySelector(`#idle${imageSource}${i + 1}`).classList.remove('hidden')

            if (i === 10) {
                document.querySelector(`#${imageSource}${i}`).classList.add('hidden')
            }

            if (i < 19) {
                let timeout = setTimeout(() => {
                    playIdleAnimation(i + 1)
                }, 1000 / 24)
                idleAnimationTimeouts.push(timeout)
            } else {
                clearIdleAnimationTimeouts()
                document.querySelector(`#idle${imageSource}${i + 1}`).classList.add('hidden')
                document.querySelector(`#${imageSource}10`).classList.remove('hidden')
            }
        }

        document.addEventListener('click', () => {
            if (!playingAnimation) {
                clearIdleAnimationTimeouts()
                hideIdleAnimations()
                restartIdleAnimation()
                playAnimation(10)
            }
        })

        function checkForDuplicateFrames() {
            const notHiddenFrames = [...document.querySelectorAll('.frame:not(.hidden)')]

            if (notHiddenFrames.length > 0) {
                notHiddenFrames.forEach((a, index) => {
                    if (index === 0) { return }
                    else {
                        a.classList.add('hidden')
                    }
                })
            }

            requestAnimationFrame(() => {
                checkForDuplicateFrames()
            })
        }

        checkForDuplicateFrames()
    </script>

</body>

</html>